C51 COMPILER V9.60.0.0   MAIN                                                              04/28/2024 19:06:11 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          //#include "delay.h"
   2          //#include "seg.h"
   3          //#include "XPT2046.h"
   4          //#include "Nixie.h"
   5          
   6          //unsigned int ADValue;
   7          //bit flag1=0;
   8          //bit flag2=0;
   9          //bit flag3=0;
  10          //sbit DA=P2^1;
  11          
  12          //unsigned char Counter,Compare;        //计数值和比较值，用于输出PWM
  13          //unsigned char i;
  14          
  15          
  16          
  17          //void Timer0_Init(void)                //1微秒@12.000MHz
  18          //{
  19          ////    AUXR |= 0x80;                   //定时器时钟1T模式
  20          //      TMOD &= 0xF0;                   //设置定时器模式
  21          //      TMOD |= 0x01;                   //设置定时器模式
  22          //      TL0 = 0xFF;                             //设置定时初始值
  23          //      TH0 = 0xFF;                             //设置定时初始值
  24          //      TF0 = 0;                                //清除TF0标志
  25          //      TR0 = 1;                                //定时器0开始计时
  26          //      ET0 = 1;                                //使能定时器0中断
  27          //      EA=1;
  28          //}
  29          
  30          
  31          
  32          
  33          //void main(void)
  34          //{
  35          //      Timer0_Init();
  36          
  37          //      while(1)
  38          //      {
  39          //                      Compare=5;
  40          //                      ADValue=XPT2046_ReadAD(XPT2046_AUX);            //读取AIN0，可调电阻
  41          ////                    Nixie_Scan(8,ADValue/1000%10);
  42          ////                    Nixie_Scan(7,(ADValue%1000/100)+12);
  43          ////                    Nixie_Scan(5,ADValue/10%10);
  44          ////                    Nixie_Scan(6,ADValue%10);
  45          ////                    Nixie_Scan(1,10);
  46          ////                    Nixie_Scan(2,10);
  47          ////                    Nixie_Scan(3,10);
  48          ////            Nixie_Scan(4,10);
  49          ////                    Nixie_Loop();//调用一次数码管驱动函数
  50          //                      flag1 =0;
  51          //                              
  52          //              Delay(80);
  53          //      }
  54          //}
C51 COMPILER V9.60.0.0   MAIN                                                              04/28/2024 19:06:11 PAGE 2   

  55          //void Timer0_Isr(void) interrupt 1
  56          //{
  57          //      
  58          //              
  59          //      TL0 = 0xF0;                             //设置定时初始值
  60          //      TH0 = 0xFF;                             //设置定时初始值
  61          //      Counter++;
  62          //      Counter%=10;    //计数值变化范围限制在0~99
  63          //      if(Counter<Compare)     //计数值小于比较值
  64          //      {
  65          //              DA=1;           //输出1
  66          //      }
  67          //      else                            //计数值大于比较值
  68          //      {
  69          //              DA=0;           //输出0
  70          //      }
  71          //      
  72          //}
  73          
  74          
  75          
  76          //void Timer1_Isr(void) interrupt 3
  77          //{
  78          //      TL1 = 0x18;                             //设置定时初始值
  79          //      TH1 = 0xFC;                             //设置定时初始值
  80          
  81          //}
  82          
  83          #include "delay.h"
  84          #include "XPT2046.h"
  85          #include "Nixie.h"
  86          
  87          unsigned int ADValue;
  88          
  89          sbit DA=P2^1;
  90          
  91          unsigned char Counter,Compare;  //计数值和比较值，用于输出PWM
  92          unsigned char i;
  93          
  94          
  95          
  96          void Timer0_Init(void)          //10us@12.000MHz
  97          {
  98   1              
  99   1              TMOD &= 0xF0;                   //设置定时器模式
 100   1              TMOD |= 0x01;                   //设置定时器模式
 101   1              TL0 = 0xFF;                             //设置定时初始值
 102   1              TH0 = 0xFF;                                     
 103   1              TF0 = 0;                                //清除TF0标志
 104   1              TR0 = 1;                                //定时器0开始计时
 105   1              ET0 = 1;                                //使能定时器0中断
 106   1              EA = 1;
 107   1              
 108   1      }
 109          
 110          
 111          void main(void)
 112          {
 113   1              Timer0_Init();
 114   1      
 115   1              while(1)
 116   1              {
C51 COMPILER V9.60.0.0   MAIN                                                              04/28/2024 19:06:11 PAGE 3   

 117   2                              Compare = 5;
 118   2                              ADValue=XPT2046_ReadAD(XPT2046_AUX);            //读取AIN3，可调电阻
 119   2      //                      Nixie_Scan(4,ADValue/1000%10);
 120   2      //                      Nixie_Scan(3,ADValue/100%10);
 121   2      //                      Nixie_Scan(2,ADValue/10%10);
 122   2      //                      Nixie_Scan(1,ADValue%10);
 123   2      //                      Nixie_Scan(5,10);
 124   2      //                      Nixie_Scan(6,10);
 125   2      //                      Nixie_Scan(7,10);
 126   2      //                      Nixie_Scan(8,10);
 127   2                              Delay(20);
 128   2              }
 129   1      }
 130          void Timer0_Isr(void) interrupt 1
 131          {
 132   1              P1_0 = ~P1_0;
 133   1              TL0 = 0xF0;                             //设置定时初始值
 134   1              TH0 = 0xFF;                                     
 135   1              Counter++;
 136   1              Counter%=10;    //计数值变化范围限制在0~99
 137   1              if(Counter<Compare)     //计数值小于比较值
 138   1              {
 139   2                      DA=1;           //输出1
 140   2              }
 141   1              else                            //计数值大于比较值
 142   1              {
 143   2                      DA=0;           //输出0
 144   2              }
 145   1              
 146   1      }
 147          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     90    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
