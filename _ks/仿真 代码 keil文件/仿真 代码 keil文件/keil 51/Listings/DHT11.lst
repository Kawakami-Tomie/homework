C51 COMPILER V9.60.0.0   DHT11                                                             07/06/2024 20:56:04 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE DHT11
OBJECT MODULE PLACED IN .\Objects\DHT11.obj
COMPILER INVOKED BY: D:\Program Files\Keil_v5\C51\BIN\C51.EXE DHT11.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(
                    -.\Listings\DHT11.lst) TABS(2) OBJECT(.\Objects\DHT11.obj)

line level    source

   1          #include "reg52.H"
   2          #include "intrins.h"
   3          #include <math.h>
   4          #include "Delay.h"
   5          
   6          sbit  Data=P3^7;
   7          unsigned char  hum;//湿度
   8          signed char  tem;//温度
   9          
  10          void DHT11_Init(void)
  11          {
  12   1        Data = 1;
  13   1        Delay(1000);
  14   1      }
  15          
  16          void Delay10us()    //@11.0592MHz
  17          {
  18   1        unsigned char i;
  19   1      
  20   1        i = 2;
  21   1        while (--i);
  22   1      }
  23          
  24          void Delay30us()    //@11.0592MHz
  25          {
  26   1        unsigned char i;
  27   1      
  28   1        i = 11;
  29   1        while (--i);
  30   1      }
  31          
  32          void Delay40us()    //@11.0592MHz
  33          {
  34   1        unsigned char i;
  35   1      
  36   1        _nop_();
  37   1        i = 15;
  38   1        while (--i);
  39   1      }
  40          
  41          void Delay80us()    //@11.0592MHz
  42          {
  43   1        unsigned char i;
  44   1      
  45   1        i = 34;
  46   1        while (--i);
  47   1      }
  48          
  49          
  50          void Delay30ms()    //@11.0592MHz
  51          {
  52   1        unsigned char i, j;
  53   1      
  54   1        i = 54;
C51 COMPILER V9.60.0.0   DHT11                                                             07/06/2024 20:56:04 PAGE 2   

  55   1        j = 199;
  56   1        do
  57   1        {
  58   2          while (--j);
  59   2        } while (--i);
  60   1      }
  61          
  62          void DHT11_start()
  63          {
  64   1        Data = 1;
  65   1        Delay10us();
  66   1        Data = 0;
  67   1        Delay30ms();
  68   1        Data = 1;
  69   1        Delay30us();
  70   1      }
  71          
  72          unsigned char DHT11_rec_byte()      //接收一个字节
  73          {
  74   1        unsigned char i,dat = 0;
  75   1        for( i = 0; i<8;i++)
  76   1        {
  77   2          while(Data == 0);
  78   2          Delay40us();
  79   2          dat <<= 1;
  80   2          if(Data == 1)
  81   2            dat += 1;
  82   2          while(Data == 1);
  83   2        }
  84   1        return dat;
  85   1      }
  86          
  87          void DHT11_receive()      //接收40位的数据
  88          {
  89   1          unsigned char R_H,R_L,T_H,T_L,RH,RL,TH,TL,revise;
  90   1        DHT11_start();
  91   1        if(Data == 0)
  92   1        {
  93   2          while(Data == 0);
  94   2          while(Data == 1);
  95   2          R_H=DHT11_rec_byte();    //接收湿度高八位
  96   2              R_L=DHT11_rec_byte();    //接收湿度低八位
  97   2              T_H=DHT11_rec_byte();    //接收温度高八位
  98   2              T_L=DHT11_rec_byte();    //接收温度低八位
  99   2              revise=DHT11_rec_byte(); //接收校正位
 100   2          Delay30us();Delay30us();
 101   2          if((R_H+R_L+T_H+T_L)==revise)      //校正
 102   2          {
 103   3            RH=R_H;
 104   3            RL=R_L;
 105   3            TH=T_H;
 106   3            TL=T_L;
 107   3          }
 108   2          hum = RH;
 109   2        }
 110   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    182    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
C51 COMPILER V9.60.0.0   DHT11                                                             07/06/2024 20:56:04 PAGE 3   

   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
